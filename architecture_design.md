# Word與PDF轉換與合併應用架構設計

## 技術選擇

### GUI框架
選擇 **PyQt5** 作為GUI框架，原因如下：
- 跨平台支援，雖主要針對Windows但保留未來擴展可能性
- 豐富的UI元件庫，支援複雜的檔案操作界面
- 良好的中文支援
- 成熟的文件與社群支援

### Word處理庫
選擇 **python-docx** 與 **docx2pdf** 作為Word文件處理庫：
- python-docx：讀取Word文件內容與結構
- docx2pdf：處理Word轉PDF的核心功能，保留格式、圖片與表格

### PDF處理庫
選擇 **PyPDF2** 與 **reportlab** 作為PDF處理庫：
- PyPDF2：處理PDF合併、頁面操作等功能
- reportlab：生成目錄、添加頁碼等高級PDF功能

### 繁體中文支援
使用以下方案支援繁體中文：
- 在GUI中使用系統字型或內嵌字型
- 在PDF生成過程中使用NotoSansCJK或WenQuanYi Zen Hei字型
- 確保所有文字處理過程使用UTF-8編碼

## 應用架構

### 共用模組
1. **GUI基礎模組**
   - 共用的UI元件與樣式
   - 檔案選擇與預覽功能
   - 進度顯示與錯誤處理

2. **檔案處理模組**
   - 檔案格式檢測
   - 檔案讀取與寫入
   - 臨時檔案管理

### Word轉PDF應用架構

1. **主界面模組**
   - 檔案選擇區域
   - 轉換選項設定區域
   - 轉換進度顯示區域
   - 輸出路徑選擇

2. **Word處理模組**
   - Word文件讀取
   - 內容與格式解析
   - 圖片與表格處理

3. **PDF生成模組**
   - 格式轉換
   - 圖片與表格保留
   - 繁體中文字型嵌入

### 多文件合併應用架構

1. **主界面模組**
   - 多檔案選擇區域
   - 檔案順序調整區域
   - 合併選項設定區域
   - 輸出路徑選擇

2. **檔案預處理模組**
   - Word檔案轉換為PDF
   - PDF檔案標準化
   - 檔案元數據提取

3. **PDF合併模組**
   - 檔案合併
   - 目錄生成
   - 頁碼添加

4. **目錄生成模組**
   - 從檔案名或內容提取標題
   - 生成目錄頁面
   - 添加目錄超連結

## 界面流程設計

### Word轉PDF應用界面流程

1. 啟動應用 → 顯示主界面
2. 點擊「瀏覽」按鈕 → 開啟檔案選擇對話框
3. 選擇Word檔案 → 顯示檔案路徑與基本資訊
4. 設定轉換選項（如有）
5. 點擊「轉換」按鈕 → 顯示進度條
6. 轉換完成 → 顯示成功訊息與輸出檔案路徑
7. 可選：點擊「開啟檔案」按鈕 → 開啟生成的PDF檔案

### 多文件合併應用界面流程

1. 啟動應用 → 顯示主界面
2. 點擊「添加檔案」按鈕 → 開啟檔案選擇對話框
3. 選擇多個Word或PDF檔案 → 在列表中顯示所選檔案
4. 通過上下按鈕或拖放調整檔案順序
5. 設定合併選項（目錄生成、頁碼添加等）
6. 點擊「合併」按鈕 → 顯示進度條
7. 合併完成 → 顯示成功訊息與輸出檔案路徑
8. 可選：點擊「開啟檔案」按鈕 → 開啟生成的PDF檔案

## 功能模組詳細設計

### 繁體中文支援模組
- 使用NotoSansCJK字型確保繁體中文正確顯示
- 在PDF生成過程中嵌入字型
- 確保所有文字處理使用UTF-8編碼

### 目錄生成模組
- 從檔案名稱提取標題
- 記錄每個檔案的起始頁碼
- 生成目錄頁面並插入合併PDF的開頭
- 添加目錄項目的超連結，指向對應頁面

### 頁碼添加模組
- 支援多種頁碼格式（數字、羅馬數字等）
- 支援頁碼位置自定義（頁面底部中央、右下角等）
- 支援頁碼起始值設定
- 可選擇是否在目錄頁面添加頁碼

## 開發與測試計劃

1. 先開發共用模組，確保基礎功能穩定
2. 分別開發Word轉PDF與多文件合併應用
3. 進行單元測試，確保各模組功能正常
4. 進行整合測試，確保應用整體功能符合需求
5. 進行使用者體驗測試，優化界面與操作流程
6. 打包應用，準備交付
