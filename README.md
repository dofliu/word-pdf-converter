# Word與PDF轉換與合併應用程式

## 專案概述

一個功能完整的文件轉換與合併工具，提供直觀的圖形化界面，專為Windows環境優化，完整支援繁體中文。

## 主要功能

1. **Word轉PDF** - 將Word文件(.docx, .doc)轉換為PDF格式，保留格式、圖片與表格
2. **PDF轉Word** - 將PDF文件轉換為可編輯的Word格式（部分實作）
3. **多文件合併** - 將多個Word或PDF文件合併為單一PDF檔案，支援：
   - 拖放調整檔案順序
   - 自動生成目錄
   - 添加頁碼（數字或羅馬數字）
   - 處理加密PDF（密碼輸入）

## 系統需求

- **作業系統**: Windows 10或更新版本
- **Python版本**: 3.6或更新版本
- **必要軟體**: Microsoft Word 2010或更新版本（用於Word轉PDF功能）
- **可選軟體**: LibreOffice（提供備選轉換方案）

## 技術架構

### 核心依賴套件
- **PyQt5** (>=5.15) - GUI框架
- **docx2pdf** (>=0.1.7) - Word轉PDF主要引擎
- **pypdf** (>=4.2.0) - PDF處理與合併
- **python-docx** (>=0.8.11) - Word文件讀取
- **pdf2docx** - PDF轉Word功能
- **reportlab** - PDF生成與頁碼添加
- **comtypes** (>=1.1.10) - Windows COM自動化
- **win32com** - Word應用程式控制（Windows專用）

### 轉換引擎策略
應用程式採用多重備援策略確保轉換成功率：
1. **方法一**: docx2pdf（主要方法）
2. **方法二**: Windows COM自動化（Word應用程式直接控制）
3. **方法三**: LibreOffice命令行（如有安裝）

## 安裝與執行

### 方法一：使用打包的執行檔（推薦）

1. 執行打包指令：
   ```bash
   python build_exe.py
   ```
2. 在 `dist/` 目錄找到 `Word_PDF_Converter.exe`
3. 雙擊執行檔啟動應用程式

### 方法二：從原始碼執行（開發模式）

1. 安裝依賴套件：
   ```bash
   pip install -r requirements.txt
   ```
2. 執行主程式：
   ```bash
   python src/integrated_app.py
   ```

## 使用指南

### 標籤頁架構

應用程式採用標籤頁設計，包含四個主要標籤：
1. **Word轉PDF** - 單一Word文件轉PDF
2. **PDF轉Word** - 單一PDF文件轉Word
3. **多文件合併PDF** - 批次處理與合併功能
4. **關於** - 版本資訊與使用須知

### Word轉PDF 標籤頁

**功能**: 將Word文件轉換為PDF格式，保留原始格式、圖片與表格

**操作流程**:
1. 點擊「瀏覽...」選擇Word檔案
2. 系統自動顯示檔案資訊（段落數、表格數、圖片數等）
3. 確認或修改輸出路徑
4. 點擊「開始轉換」
5. 轉換完成後點擊「開啟檔案」查看結果

**技術特點**:
- 多重備援轉換引擎（docx2pdf → COM → LibreOffice）
- 自動處理繁體中文字型
- 智能進度估算（基於檔案大小）
- 即時顯示檔案元數據與預計時間
- 支援 .docx 與 .doc 格式

**進度顯示改進**:
- ✨ 根據檔案大小動態估算轉換時間
- ✨ 平滑的進度條更新（每0.2秒）
- ✨ 顯示檔案大小與預計完成時間
- ✨ 三階段進度回報：準備 → 轉換 → 驗證

### PDF轉Word 標籤頁

**功能**: 將PDF文件轉換為可編輯的Word格式，盡可能保留原始排版

**操作流程**:
1. 點擊「瀏覽...」選擇PDF檔案
2. 系統自動顯示檔案資訊（頁數、大小、元數據）
3. 選擇轉換品質選項：
   - **預設**: 標準轉換速度與品質
   - **高品質**: 保留更多格式細節（較慢）
   - **純文字**: 僅提取文字內容（最快）
4. 確認或修改輸出路徑
5. 點擊「開始轉換」
6. 轉換完成後點擊「開啟檔案」查看結果

**技術特點**:
- 使用 `pdf2docx` 高品質轉換引擎
- 智能進度估算（基於頁數與檔案大小）
- 支援三種轉換品質選項
- 自動顯示PDF元數據（標題、作者）
- 平滑進度條更新與剩餘時間顯示

**轉換品質說明**:
- **預設**: 適合一般PDF，速度與品質平衡
- **高品質**: 適合複雜排版，保留更多格式（開發中）
- **純文字**: 適合僅需提取文字內容（開發中）

**注意事項**:
- 掃描版PDF（圖片型）轉換效果有限，建議先進行OCR
- 加密或受保護的PDF可能無法轉換
- 複雜表格和特殊字型可能無法完美還原
- 大型PDF（>100頁）轉換時間較長

### 多文件合併PDF 標籤頁

**功能**: 將多個Word或PDF文件合併為單一PDF，支援目錄生成與頁碼添加

**操作流程**:
1. 點擊「添加檔案」選擇多個檔案（支援Word與PDF混合）
2. 使用「上移」/「下移」或拖放調整檔案順序
3. 設定合併選項：
   - 「生成目錄」: 在開頭自動建立目錄頁
   - 「添加頁碼」: 底部中央位置添加頁碼
   - 頁碼格式: 數字 / 羅馬數字
   - 起始頁碼: 自訂起始數字
4. 點擊「選擇...」設定輸出路徑
5. 點擊「開始合併」執行
6. 完成後點擊「開啟檔案」查看結果

**進階功能**:
- **加密PDF處理**: 自動檢測加密PDF並彈出密碼輸入視窗
- **混合格式支援**: Word文件自動轉換後合併
- **目錄頁生成**: 使用檔案名稱作為標題，自動計算頁碼
- **拖放排序**: 支援直接拖放調整檔案順序

## 專案結構

```
word_pdf_converter_final/
├── src/
│   └── integrated_app.py       # 主程式（整合版應用）
├── architecture_design.md       # 架構設計文件
├── build_exe.py                 # PyInstaller打包腳本
├── Word_PDF_Converter.spec     # PyInstaller配置檔
├── requirements.txt             # Python依賴套件清單
└── README.md                    # 本文件
```

## 已知問題與限制

### 近期改善項目 ✅
1. ~~**PDF轉Word功能未完整實作**~~ - ✅ 已修復（2025-09-30）
   - 已新增完整的 PDF轉Word 標籤頁
   - 支援三種轉換品質選項
   - 智能進度估算與平滑更新

2. ~~**密碼輸入機制待優化**~~ - ✅ 已修復（2025-09-30）
   - 已實作完整的信號槽機制
   - 支援密碼錯誤重試與使用者取消
   - 執行緒安全的密碼輸入對話框

3. ~~**進度條不精確**~~ - ✅ 已改善（2025-09-30）
   - 根據檔案大小/頁數動態估算轉換時間
   - 平滑進度條更新（每0.2秒）
   - 顯示預計完成時間與三階段狀態

### 功能限制
- 僅完整支援Windows作業系統
- Word轉PDF依賴Microsoft Word或LibreOffice
- 大型檔案（>50MB）轉換速度較慢
- 目錄頁最多顯示50個字元的檔名

## 常見問題排解

**Q: 轉換失敗，顯示「Microsoft Word未正確安裝」**
A: 確認已安裝Microsoft Word，或安裝LibreOffice作為替代方案

**Q: 合併PDF時程式無回應**
A: 可能是處理加密PDF，請等待密碼輸入視窗彈出

**Q: 打包的exe無法執行**
A: 確認已正確安裝PyInstaller並執行 `build_exe.py`，檢查dist目錄是否有生成檔案

**Q: 繁體中文顯示為方框**
A: 確認系統已安裝微軟正黑體（msjh.ttc）或其他中文字型

## 開發資訊

- **版本**: 1.4.0 (穩定版)
- **開發語言**: Python 3.6+
- **GUI框架**: PyQt5
- **授權**: 個人或教育用途
- **聯絡方式**: moredof@gmail.com

## 版權聲明

© 2025 Word與PDF轉換工具
本應用程式僅供個人或教育用途使用
