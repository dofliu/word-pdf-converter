# Word與PDF轉換工具 - 待辦事項

> 最後更新：2025-09-30
> 版本：1.4.0
> 完成進度：3/15 (20%)

## 📊 快速進度概覽

- 🔴 **高優先級**: 3/3 完成 (100%) ✅
- 🟡 **中優先級**: 0/4 完成 (0%)
- 🟢 **低優先級**: 0/5 完成 (0%)
- 🔵 **系統層級**: 0/3 完成 (0%)

## 📋 專案待辦事項總覽

### 🔴 高優先級（核心功能完善）

#### 1. 完善PDF轉Word功能並整合到主界面 ✅
**狀態**: ✅ 已完成
**難度**: ⭐⭐⭐
**實際時間**: 2-3小時
**完成日期**: 2025-09-30

**描述**:
- ✅ `PdfToWordThread` 類別已實作（L254-293）
- ✅ 已新增對應的 `PdfToWordTab` 標籤頁（L539-747）
- ✅ 已整合到主視窗的 `IntegratedApp` 類別中（L1402-1403）
- ✅ 使用 `pdf2docx` 庫進行轉換

**實作功能**:
- ✅ 完整的 UI 界面（檔案選擇、進度顯示、轉換選項）
- ✅ PDF 檔案資訊顯示（頁數、大小、元數據）
- ✅ 轉換品質選項（預設/高品質/純文字）
- ✅ 錯誤處理與狀態回饋
- ✅ 轉換完成後開啟檔案功能

**相關檔案**:
- [src/integrated_app.py:254-293](src/integrated_app.py#L254-L293) - PdfToWordThread 執行緒
- [src/integrated_app.py:539-747](src/integrated_app.py#L539-L747) - PdfToWordTab UI 類別
- [src/integrated_app.py:1402-1403](src/integrated_app.py#L1402-L1403) - 主視窗整合

**實作檢查清單**:
- ✅ 建立 `PdfToWordTab` UI 類別（參考 `WordToPdfTab` 設計）
- ✅ 在主視窗新增第二個標籤頁（位於Word轉PDF之後）
- ✅ 實作檔案選擇與預覽功能
- ✅ 實作轉換品質選項
- ✅ 錯誤處理完整
- ⚠️ 更新使用說明文件（待完成）
- ⚠️ 實際轉換品質測試（待使用者測試）

---

#### 2. 實作並測試加密PDF密碼輸入機制 ✅
**狀態**: ✅ 已完成
**難度**: ⭐⭐⭐⭐
**實際時間**: 3小時
**完成日期**: 2025-09-30

**描述**:
- ✅ 密碼輸入相關程式碼已實作並啟用
- ✅ `MergePdfThread._prepare_pdf_reader()` 已有密碼處理邏輯（L352-381）
- ✅ 已實作主視窗的信號槽機制以支援執行緒安全的密碼輸入

**技術實作**:
- ✅ 在背景執行緒中安全地彈出密碼輸入對話框
- ✅ 實作信號槽機制：`password_requested`、`wrong_password`、`decrypt_error`
- ✅ 處理使用者取消輸入的情況
- ✅ 實作事件循環等待機制（QEventLoop + QTimer）
- ✅ 最大等待時間60秒

**相關檔案**:
- [src/integrated_app.py:352-381](src/integrated_app.py#L352-L381) - _prepare_pdf_reader 方法
- [src/integrated_app.py:1152-1154](src/integrated_app.py#L1152-L1154) - PyQt 信號定義
- [src/integrated_app.py:1202-1256](src/integrated_app.py#L1202-L1256) - 密碼輸入方法
- [test_password.py](test_password.py) - 測試腳本
- [TEST_PASSWORD_GUIDE.md](TEST_PASSWORD_GUIDE.md) - 測試指南

**實作檢查清單**:
- ✅ 在 `IntegratedApp` 類別新增 PyQt 信號定義
- ✅ 實作 `get_password()` 和 `wait_for_password()` 方法
- ✅ 實作 `show_wrong_password_warning()` 槽函數
- ✅ 實作 `show_decrypt_error()` 槽函數
- ✅ 連接信號與槽函數
- ✅ 建立測試檔案與測試指南
- ⚠️ 測試多次密碼錯誤的情況（待使用者測試）
- ⚠️ 測試使用者取消操作的處理（待使用者測試）

**測試狀態**:
- 程式碼實作完成 ✅
- 測試環境建立完成 ✅
- 實際使用測試待執行 ⚠️

---

#### 3. 改善Word轉PDF進度條顯示精確度 ✅
**狀態**: ✅ 已完成
**難度**: ⭐⭐
**實際時間**: 1.5小時
**完成日期**: 2025-09-30

**描述**:
- ✅ 實作基於檔案大小的智能時間估算
- ✅ 平滑進度條更新機制（每0.2秒更新）
- ✅ 顯示預計完成時間
- ✅ 三階段狀態回報（準備 → 轉換 → 驗證）

**實作方案**:
採用「基於檔案大小的時間估算 + 平滑進度更新」方案

**技術實作**:
- ✅ `_estimate_conversion_time()` - 根據檔案大小估算轉換時間
  - 公式：3秒（基礎）+ 檔案大小(MB) × 2秒
  - 限制：3-60秒範圍
- ✅ `_update_progress_smooth()` - 背景執行緒平滑更新進度
  - 更新間隔：0.2秒
  - 進度範圍：10% → 85%
- ✅ 狀態訊息顯示檔案大小與預計時間
- ✅ 同時改善 PdfToWordThread（基於頁數估算）

**相關檔案**:
- [src/integrated_app.py:295-391](src/integrated_app.py#L295-L391) - WordToPdfThread 新實作
- [src/integrated_app.py:254-363](src/integrated_app.py#L254-L363) - PdfToWordThread 新實作

**實作檢查清單**:
- ✅ 實作檔案大小分析與時間估算
- ✅ 實作平滑進度更新邏輯
- ✅ 新增轉換速度估算（剩餘時間）顯示
- ✅ 同步改善 PDF轉Word 進度條
- ✅ 測試語法正確性
- ⚠️ 實際轉換測試（待使用者測試）

**改善效果**:
- 進度條不再跳躍式更新
- 使用者可看到預估時間
- 進度更新更符合直覺
- 檔案資訊更詳細

---

### 🟡 中優先級（功能增強）

#### 4. 優化大型檔案處理效能（>50MB）
**狀態**: 待處理
**難度**: ⭐⭐⭐⭐
**預估時間**: 4-6小時

**建議方向**:
- 實作分頁轉換機制
- 新增記憶體使用監控
- 優化臨時檔案管理
- 實作轉換佇列機制

**實作檢查清單**:
- [ ] 效能基準測試（50MB、100MB、200MB 檔案）
- [ ] 實作記憶體使用監控
- [ ] 優化 PDF 讀取與寫入流程
- [ ] 新增低記憶體模式選項

---

#### 5. 新增批次轉換功能（多個Word同時轉PDF）
**狀態**: 待開發
**難度**: ⭐⭐⭐
**預估時間**: 4-5小時

**功能規劃**:
- 支援選擇多個Word檔案
- 顯示批次轉換進度列表
- 支援暫停/繼續/取消個別任務
- 轉換完成後生成報告

**實作檢查清單**:
- [ ] 設計批次轉換UI（可參考下載管理器）
- [ ] 實作任務佇列管理
- [ ] 實作多執行緒轉換（控制並行數量）
- [ ] 新增轉換日誌與錯誤報告

---

#### 6. 實作轉換歷史記錄功能
**狀態**: 待開發
**難度**: ⭐⭐
**預估時間**: 2-3小時

**功能規劃**:
- 記錄所有轉換操作（時間、檔案、結果）
- 支援快速重新轉換
- 支援匯出轉換記錄為CSV
- 顯示統計資訊（總轉換次數、成功率等）

**實作檢查清單**:
- [ ] 設計歷史記錄資料結構（JSON 或 SQLite）
- [ ] 新增歷史記錄標籤頁
- [ ] 實作記錄查詢與篩選功能
- [ ] 實作「重新執行」功能

---

#### 7. 新增轉換品質設定選項（DPI、壓縮率等）
**狀態**: 待開發
**難度**: ⭐⭐⭐
**預估時間**: 3-4小時

**功能規劃**:
- PDF 品質設定：低（150 DPI）/ 中（300 DPI）/ 高（600 DPI）
- 圖片壓縮選項
- 色彩模式：彩色 / 灰階
- 字型嵌入選項

**實作檢查清單**:
- [ ] 研究各轉換引擎的品質參數
- [ ] 新增進階設定對話框
- [ ] 實作品質預設配置
- [ ] 測試不同設定的輸出效果與檔案大小

---

### 🟢 低優先級（體驗優化）

#### 8. 優化錯誤處理與使用者提示訊息
**狀態**: 待改善
**難度**: ⭐⭐
**預估時間**: 2小時

**改善方向**:
- 統一錯誤訊息格式
- 提供更具體的錯誤解決建議
- 新增錯誤代碼系統
- 實作錯誤日誌記錄

---

#### 9. 改善目錄頁視覺設計與自訂選項
**狀態**: 待改善
**難度**: ⭐⭐⭐
**預估時間**: 3小時

**功能規劃**:
- 支援多種目錄樣式（簡約 / 經典 / 現代）
- 自訂目錄標題
- 自訂字型與顏色
- 新增目錄項目縮排層級

**相關檔案**:
- [src/integrated_app.py:457-486](src/integrated_app.py#L457-L486) - create_toc 方法

---

#### 10. 支援頁碼位置自訂（左/中/右，上/下）
**狀態**: 待開發
**難度**: ⭐⭐
**預估時間**: 2小時

**目前狀態**: 頁碼固定在底部中央（L510）

**相關檔案**:
- [src/integrated_app.py:488-523](src/integrated_app.py#L488-L523) - add_page_numbers 方法

**實作檢查清單**:
- [ ] 新增位置選擇 ComboBox
- [ ] 計算不同位置的座標
- [ ] 支援頁眉與頁腳
- [ ] 新增頁碼格式自訂（字型、大小、顏色）

---

#### 11. 新增PDF預覽功能
**狀態**: 待開發
**難度**: ⭐⭐⭐⭐
**預估時間**: 5-6小時

**技術方案**:
- 使用 PyMuPDF (fitz) 渲染 PDF 頁面
- 實作縮圖預覽
- 支援頁面跳轉與縮放

---

#### 12. 實作拖放檔案到視窗功能
**狀態**: 待開發
**難度**: ⭐⭐
**預估時間**: 1-2小時

**實作檢查清單**:
- [ ] 啟用視窗拖放事件
- [ ] 實作 dragEnterEvent 和 dropEvent
- [ ] 自動識別檔案類型並導向對應標籤頁
- [ ] 新增視覺提示（拖放區域高亮）

---

### 🔵 系統層級改善

#### 13. 實作自動更新檢查機制
**狀態**: 待開發
**難度**: ⭐⭐⭐
**預估時間**: 4小時

**功能規劃**:
- 檢查 GitHub Releases 或自定義伺服器
- 顯示更新通知對話框
- 支援自動下載與安裝
- 版本比對機制

---

#### 14. 編寫單元測試與整合測試
**狀態**: 待開發
**難度**: ⭐⭐⭐⭐
**預估時間**: 8-10小時

**測試範圍**:
- Word 轉 PDF 轉換功能
- PDF 合併功能
- 目錄生成功能
- 頁碼添加功能
- 密碼處理機制
- 字型處理

**實作檢查清單**:
- [ ] 建立測試資料集（各種格式的 Word 和 PDF）
- [ ] 使用 pytest 編寫單元測試
- [ ] 實作 GUI 測試（使用 pytest-qt）
- [ ] 設定 CI/CD 自動測試

---

#### 15. 優化跨平台支援（macOS、Linux）
**狀態**: 待改善
**難度**: ⭐⭐⭐⭐⭐
**預估時間**: 10-15小時

**目前狀態**: 主要針對 Windows，Linux/macOS 支援不完整

**需要處理**:
- COM 自動化替代方案（僅 Windows 可用）
- 字型路徑處理（L42-108）
- LibreOffice 路徑檢測
- 檔案路徑處理（Windows vs Unix）

---

## 📊 優先級矩陣

| 項目 | 優先級 | 影響範圍 | 實作難度 | 狀態 |
|------|--------|----------|----------|------|
| PDF轉Word整合 | 🔴 高 | 核心功能 | 中 | ✅ 已完成 |
| 加密PDF密碼輸入 | 🔴 高 | 核心功能 | 高 | ✅ 已完成 |
| 進度條精確度 | 🔴 高 | 使用體驗 | 低 | ✅ 已完成 |
| 大型檔案優化 | 🟡 中 | 效能 | 高 | ⏳ 待處理 |
| 批次轉換 | 🟡 中 | 功能擴充 | 中 | ⏳ 待處理 |
| 轉換歷史 | 🟡 中 | 功能擴充 | 低 | ⏳ 待處理 |
| 品質設定 | 🟡 中 | 功能擴充 | 中 | ⏳ 待處理 |
| 錯誤處理優化 | 🟢 低 | 穩定性 | 低 | ⏳ 待處理 |
| 目錄視覺設計 | 🟢 低 | 使用體驗 | 中 | ⏳ 待處理 |
| 頁碼位置自訂 | 🟢 低 | 功能擴充 | 低 | ⏳ 待處理 |
| PDF預覽 | 🟢 低 | 功能擴充 | 高 | ⏳ 待處理 |
| 拖放功能 | 🟢 低 | 使用體驗 | 低 | ⏳ 待處理 |
| 自動更新 | 🔵 系統 | 維護性 | 中 | ⏳ 待處理 |
| 單元測試 | 🔵 系統 | 品質保證 | 高 | ⏳ 待處理 |
| 跨平台支援 | 🔵 系統 | 擴展性 | 極高 | ⏳ 待處理 |

---

## 🎯 建議實作順序

### 第一階段：核心功能完善（1-2週）
1. 加密PDF密碼輸入機制（最重要的缺失功能）
2. PDF轉Word功能整合
3. 進度條精確度改善

### 第二階段：功能增強（2-3週）
4. 批次轉換功能
5. 轉換品質設定
6. 轉換歷史記錄

### 第三階段：體驗優化（1-2週）
7. 錯誤處理優化
8. 拖放功能
9. 目錄與頁碼自訂

### 第四階段：系統層級（長期）
10. 單元測試建立
11. 大型檔案優化
12. 跨平台支援改善

---

## 📝 開發備註

### 程式碼品質改善
- [ ] 補充文件字串（docstring）
- [ ] 統一命名規範
- [ ] 重構重複程式碼
- [ ] 新增類型提示（type hints）

### 文件改善
- [ ] 新增開發者指南
- [ ] 補充 API 文件
- [ ] 新增貢獻指南
- [ ] 建立 CHANGELOG

### 部署相關
- [ ] 優化打包流程
- [ ] 新增安裝程式製作
- [ ] 建立 GitHub Actions CI/CD
- [ ] 準備應用程式圖示

---

## 🐛 已知 Bug 追蹤

1. ~~**密碼輸入機制未啟用**~~ - ✅ 已修復（2025-09-30）
2. **進度條不準確** - ⏳ 使用模擬進度值，待改善
3. **大型檔案可能造成記憶體不足** - ⏳ 缺少分頁處理，待優化

### 修復歷史
- **2025-09-30**: 實作並啟用加密PDF密碼輸入機制
  - 新增 PyQt 信號槽機制
  - 實作執行緒安全的密碼輸入對話框
  - 支援密碼錯誤重試與使用者取消操作

---

## 💡 功能建議清單

### 社群建議功能（待評估）
- [ ] 支援更多格式（PPT、Excel、圖片）
- [ ] 加入浮水印功能
- [ ] PDF 加密與權限設定
- [ ] OCR 文字識別（掃描PDF轉可編輯Word）
- [ ] 雲端儲存整合（Google Drive、Dropbox）
- [ ] 命令列介面（CLI）版本

---

**文件版本**: v1.0
**維護者**: moredof@gmail.com
**最後更新**: 2025-09-30